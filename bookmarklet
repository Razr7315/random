javascript:(function(){    const introUrl = "https://github.com/Razr7315/random/raw/refs/heads/main/chirp.mp3";    let lastFetchedId = null;    let lastChirpTime = 0;    const audioPlayed = new Set();    const SHEET_URLS = [        "https://docs.google.com/spreadsheets/d/15g3Gyf3Yop2AB06a3csykAqtnG1yD3Fv5pvI4C96E88/pub?output=csv&gid=1831726116",        "https://docs.google.com/spreadsheets/d/15g3Gyf3Yop2AB06a3csykAqtnG1yD3Fv5pvI4C96E88/pub?output=csv&gid=461398093",        "https://docs.google.com/spreadsheets/d/15g3Gyf3Yop2AB06a3csykAqtnG1yD3Fv5pvI4C96E88/pub?output=csv&gid=1449508473",        "https://docs.google.com/spreadsheets/d/15g3Gyf3Yop2AB06a3csykAqtnG1yD3Fv5pvI4C96E88/pub?output=csv&gid=1598743147",        "https://docs.google.com/spreadsheets/d/15g3Gyf3Yop2AB06a3csykAqtnG1yD3Fv5pvI4C96E88/pub?output=csv&gid=1093000678"    ];    let radioDataCache = null;    let prefixDataCache = null;    async function fetchRadioData() {        const responses = await Promise.all(SHEET_URLS.map(url => fetch(url).then(res => res.text())));        const radioData = new Map();        const prefixData = [];        responses.forEach((text,index)=>{            const rows = text.split(%27\n%27).slice(1).map(r=>r.split(%27,%27).map(c=>c.trim()));            if(index<4){                rows.forEach(([id,company,radioNumber,unit,type])=>{                    if(id) radioData.set(id,{company,radioNumber,unit,type});                });            }else{                rows.forEach(([prefix,type,county,length])=>{                    if(prefix && type && county && !isNaN(length)) prefixData.push({prefix,type,county,length:parseInt(length,10)});                });            }        });        radioDataCache = radioData;        prefixDataCache = prefixData;    }    async function radioFetch(id){        if(!radioDataCache || !prefixDataCache) await fetchRadioData();        if(radioDataCache.has(id)) return radioDataCache.get(id);        for(const {prefix,type,county,length} of prefixDataCache){            if(id.startsWith(prefix) && id.length===length) return {unit:`${county} ${type}`,id};        }        return null;    }    function isBroadcastify(){ return window.location.href.includes(%27broadcastify.com%27); }    async function checkRadioId(){        if(!isBroadcastify()) return;        const callSrcElement = document.getElementById("call_src");        if(callSrcElement && callSrcElement.innerText.trim()){            const radioId = callSrcElement.innerText.trim();            if(radioId!==lastFetchedId){                lastFetchedId=radioId;                const response = await radioFetch(radioId);                if(response){                    let newTitle = document.title;                    if(response.unit && response.type){                        callSrcElement.innerText=`${response.unit} ${response.type} (${radioId})`;                        newTitle=`${document.title} - ${response.unit}`;                    } else if(response.unit){                        callSrcElement.innerText=`${response.unit} (${radioId})`;                        newTitle=`${document.title} - ${response.unit}`;                    }                    document.title=newTitle;                }            }        }    }    function playIntroBeforeEveryAudio(event){        const originalElement = event.target;        const currentTime = Date.now();        const timeSinceLastChirp = currentTime-lastChirpTime;        if(originalElement.__isInterrupted) return;        if(timeSinceLastChirp<60000) return;        lastChirpTime=currentTime;        event.preventDefault();        event.stopImmediatePropagation();        originalElement.__isInterrupted=true;        const intro = new Audio(introUrl);        intro.volume=1.0;        const originalVolume = originalElement.volume;        originalElement.volume=Math.max(0.1, originalElement.volume*0.3);        intro.play().catch(()=>{originalElement.__isInterrupted=false; originalElement.play().catch(()=>{});});        intro.addEventListener("ended",()=>{            originalElement.__isInterrupted=false;            originalElement.volume=originalVolume;            originalElement.play().catch(()=>{});        });    }    function hookAllAudioElements(){        if(!isBroadcastify()) return;        const elements=document.querySelectorAll("audio,video");        elements.forEach(el=>{            el.removeEventListener("play",playIntroBeforeEveryAudio);            el.addEventListener("play",playIntroBeforeEveryAudio);        });    }    const observer=new MutationObserver(hookAllAudioElements);    observer.observe(document.body,{childList:true,subtree:true});    hookAllAudioElements();    setInterval(checkRadioId,500);})();
